



Messaging Layer Security                                      K. Kohbrok
Internet-Draft                                                 R. Robert
Intended status: Informational                               Phoenix R&D
Expires: 22 August 2026                                 18 February 2026


                   Using MLS as Handshake in TLS 1.3
                      draft-kohbrok-mls-tls-latest

Abstract

   This document details how MLS can be combined with the TLS record
   layer to yield a secure channel protocol that can be configured to be
   post-quantum secure and that is suitable for long-lived connection
   thanks to MLS key updates.  In the context of this composed protocol,
   MLS acts as a continuous key agreement protocol that allows initiator
   and responder to update their key material not just to achieve
   forward-secrecy, but also to post-compromise security.

About This Document

   This note is to be removed before publishing as an RFC.

   The latest revision of this draft can be found at
   https://kkohbrok.github.io/draft-kohbrok-mls-tls/draft-kohbrok-mls-
   tls.html.  Status information for this document may be found at
   https://datatracker.ietf.org/doc/draft-kohbrok-mls-tls/.

   Discussion of this document takes place on the Messaging Layer
   Security Working Group mailing list (mailto:mls@ietf.org), which is
   archived at https://mailarchive.ietf.org/arch/browse/mls/.  Subscribe
   at https://www.ietf.org/mailman/listinfo/mls/.

   Source for this draft and an issue tracker can be found at
   https://github.com/kkohbrok/draft-kohbrok-mls-tls.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 22 August 2026.

Copyright Notice

   Copyright (c) 2026 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
   2.  Protocol Overview
   3.  Initializing the record layer
   4.  Updating record layer keys
   5.  Security Considerations
   6.  IANA Considerations
   7.  Normative References
   Acknowledgments
   Authors' Addresses

1.  Introduction

   This document builds on the two-party profile for MLS
   [I-D.draft-kohbrok-mls-two-party-profile] and combines it with the
   record layer of TLS 1.3 [RFC8446] to yield a secure channel protocol.
   The composition of both protocols is seamless due to the modular
   design of TLS 1.3 and MLS capability to act as a continuous key
   agreement protocol.  After the initial handshake, initiator and
   responder can tunnel MLS commits through the secure channel to update
   their key material.  Key material updates allow both parties to
   achieve forward-secrecy and post-compromise security.

2.  Protocol Overview

   The TLS variant with MLS as handshake is not interoperable with
   vanilla TLS 1.3.  As such, a responder that wants to serve both
   variants needs to listen on individual ports.

   The protocol consists of three phases.

   1.  Initial key agreement, where initiator and responder agree on key
       material using the MLS two party profile.

   2.  Secure channel phase, where initiator and responder can transfer
       data encrypted using the TLS 1.3 record layer protocol.  The
       encryption keys are derived from the MLS group created during the
       initial key agreement phase.  During the secure channel phase,
       initiator and responder can tunnel MLS commits through the secure
       channel to update their key material.

   3.  Resumption, where initiator or responder can resume a previously
       interrupted connection without having to repeat phase 1,
       including the ability to send data in the first flight of
       messages.

   For more details on the initial key agreement, resumption, as well as
   how message updates work, see
   [I-D.draft-kohbrok-mls-two-party-profile].

3.  Initializing the record layer

   Both after the initial key agreement phase and the resumption phase,
   initiator and responder derive key material from the MLS group
   created during the initial key agreement phase.

   The client_application_traffic_secret and the
   server_application_traffic_secret required by the record layer are
   derived as follows.

   server_application_traffic_secret =
     MLS-Exporter("MLS-TLS s ap traffic", [], Length)

   client_application_traffic_secret =
     MLS-Exporter("MLS-TLS c ap traffic", [], Length)

   Where MLS-Exporter is defined in [RFC9420] and Length is the size of
   the secret required by the TLS record layer.

4.  Updating record layer keys

   The MLS two party profile allows both parties to update the MLS group
   created in the initial key agreement phase.  In the context of MLS-
   TLS, these ConnectionUpdate and EpochKeyUpdate messages (as defined
   in [I-D.draft-kohbrok-mls-two-party-profile]) are sent in place of
   key update messages defined in [RFC8446].  Concretely, they
   serialized and sent as the content of a TLSInnerPlaintext message
   with type set to handshake.

   TODO: The two-party profile I-D should define a message similar to
   [RFC9420]'s MLSMessage, which contains either a ClientHello,
   ServerHello, ConnectionUpdate or EpochKeyUpdate.  This is to allow
   recipients to know what to deserialize when they receive an in-band
   update message.

   When a party is clear to start using the key material as specified in
   Section 4 of [I-D.draft-kohbrok-mls-two-party-profile], the client
   derives new application traffic secrets as specified in Section 3.

5.  Security Considerations

   TODO Security

6.  IANA Considerations

   This document has no IANA actions.

7.  Normative References

   [I-D.draft-kohbrok-mls-two-party-profile]
              Kohbrok, K. and R. Robert, "A two-party profile for MLS",
              Work in Progress, Internet-Draft, draft-kohbrok-mls-two-
              party-profile-00, 3 February 2026,
              <https://datatracker.ietf.org/doc/html/draft-kohbrok-mls-
              two-party-profile-00>.

   [RFC8446]  Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", RFC 8446, DOI 10.17487/RFC8446, August 2018,
              <https://www.rfc-editor.org/rfc/rfc8446>.

   [RFC9420]  Barnes, R., Beurdouche, B., Robert, R., Millican, J.,
              Omara, E., and K. Cohn-Gordon, "The Messaging Layer
              Security (MLS) Protocol", RFC 9420, DOI 10.17487/RFC9420,
              July 2023, <https://www.rfc-editor.org/rfc/rfc9420>.

Acknowledgments

   TODO acknowledge.

Authors' Addresses

   Konrad Kohbrok
   Phoenix R&D
   Email: konrad@ratchet.ing


   Raphael Robert
   Phoenix R&D
   Email: ietf@raphaelrobert.com
